import{r as n}from"./index-DfBREQpt.js";const C=(t,f)=>f,k=({dragElem:t,boundElem:f,checkBounds:y=C,allowedDirections:s=["x","y"],startingPos:w})=>{const[E,g]=n.useState(!1),L=n.useRef(!1),o=n.useRef({x:0,y:0}),m=n.useRef({x:0,y:0}),[x,h]=n.useState(null),R=n.useRef(x||{x:0,y:0}),p=n.useRef(!1);n.useEffect(()=>{R.current=x||w||{x:0,y:0}},[x,w]);const l=n.useCallback(e=>{if(L.current&&(e.stopPropagation(),t&&t.current)){const r={x:o.current.x-m.current.x,y:o.current.y-m.current.y};let i=0,a=0;"clientX"in e?(i=e.clientX,a=e.clientY):"touches"in e&&(e.preventDefault(),i=e.touches[0].clientX,a=e.touches[0].clientY);const d={x:s.includes("x")?r.x+i:o.current.x,y:s.includes("y")?r.y+a:o.current.y};let c=d;y&&(c=y(t.current,d,r,f?f.current:null)),c={x:s.includes("x")?c.x:o.current.x,y:s.includes("y")?c.y:o.current.y},h(c)}},[t,f,y,s]),u=n.useCallback(()=>{L.current=!1,g(()=>!1),t.current?.classList.remove("dragging")},[t]),v=n.useCallback(e=>{e.stopPropagation(),L.current=!0,g(()=>!0),"clientX"in e?m.current={x:e.clientX,y:e.clientY}:"touches"in e&&(m.current={x:e.touches[0].clientX,y:e.touches[0].clientY}),o.current=R.current,t.current?.classList.add("dragging")},[t]),X=()=>{h({x:0,y:0}),p.current=!1},Y=e=>{const i=window.getComputedStyle(e).transform;let a={x:0,y:0};if(i&&i!=="none"){const d=i.match(/matrix.*\((.+)\)/);if(d){const c=d[1].split(", "),M=parseFloat(c[4]),S=parseFloat(c[5]);a={x:M,y:S}}}queueMicrotask(()=>{h(a)})};return n.useLayoutEffect(()=>{const e=t.current;e&&!p.current&&(Y(e),p.current=!0)},[t]),n.useEffect(()=>{const e=t.current;return e&&(e.addEventListener("mousedown",v),window.addEventListener("mousemove",l),window.addEventListener("mouseup",u),e.addEventListener("touchstart",v,{passive:!0}),e.addEventListener("touchmove",l,{passive:!1}),window.addEventListener("touchend",u),window.addEventListener("touchcancel",u),s.forEach(r=>{e.classList.add("drag-elem"),e.classList.add(`drag-direction-${r}`)})),()=>{e&&(e.removeEventListener("mousedown",v),window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",u),e.removeEventListener("touchstart",v),e.removeEventListener("touchmove",l),window.removeEventListener("touchend",u),window.removeEventListener("touchcancel",u),s.forEach(r=>{e.classList.remove("drag-elem"),e.classList.remove(`drag-direction-${r}`)}))}},[s,t,v,l,u]),{transform:x,reset:X,isDragging:E}};export{k as u};
